<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="../../../WEB-INF/template-cadastro.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:b="http://bootsfaces.net/ui"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core">

    <ui:define name="conteudo-cadastro">
        <h3>operação >> #{produtoController.editando ? 'edição de cadastro' : 'Novo cadastro'}</h3>

        <h:form id="form" enctype="multipart/form-data">
            <b:messages id="msgs" />
            <b:panelGrid col-spans="12">
                <b:inputText label="Título" value="#{produtoController.produto.titulo}" 
                             placeholder="título da postagem"
                             maxlength="255" required="true" requiredMessage="informe o título"/>

                <b:inputTextarea label="SubTítulo" value="#{produtoController.produto.subTitulo}"
                                 placeholder="subtítulo da postagem"
                                 maxlength="255" required="true" requiredMessage="informe o sub título"/>

                <b:selectOneMenu label="Promoção" value="#{produtoController.produto.promocao}"  
                                  requiredMessage="campo obrigatório"
                                  style="width: 100%;">
                    <f:attribute name="collectionType" value="java.util.ArrayList" />

                    <f:selectItems value="#{promocaoController.promocaos}" var="p"
                                   itemLabel="#{p.descricao}" itemValue="#{p}" />
                </b:selectOneMenu>
                
            </b:panelGrid>

            <b:panelGrid col-spans="6,6">
                <b:selectOneMenu label="Categoria" value="#{produtoController.produto.subCategoria}"  
                                 required="true" requiredMessage="campo obrigatório">
                    <f:attribute name="collectionType" value="java.util.ArrayList" />
                    <f:selectItem itemLabel="categoria" itemValue="" />
                    <f:selectItems value="#{subCategoriaController.subCategorias}" var="cat"
                                   itemLabel="#{cat.nome}" itemValue="#{cat}" />
                </b:selectOneMenu>

                <b:selectOneMenu label="Entidade" value="#{produtoController.produto.pessoaJuridica}"  
                                 required="true" requiredMessage="campo obrigatório">
                    <f:attribute name="collectionType" value="java.util.ArrayList" />
                    <f:selectItem itemLabel="entidade" itemValue="" />
                    <f:selectItems value="#{pessoaJuridicaController.pessoaJuridicas}" var="cat"
                                   itemLabel="#{cat.nome}" itemValue="#{cat}" />
                </b:selectOneMenu>
            </b:panelGrid>

            <b:panelGrid col-spans="6,6">
                <b:inputText label="Preço" value="#{produtoController.produto.preco}"/>
                <b:inputText label="Quantidade" value="#{produtoController.produto.quantidade}"/>
            </b:panelGrid>

            <b:panelGrid columns="2" styleClass="ui-panelgrid-blank form-group"> 
                <p:selectBooleanButton id="value2" value="#{produtoController.produto.status}" onLabel="Disponivel" 
                                       offLabel="Não disponivel" onIcon="ui-icon-check" offIcon="ui-icon-close" style="width:200px">
                    <p:ajax update="msgs" listener="#{produtoController.addMessageDisponivel()}" />
                </p:selectBooleanButton>

                <p:selectBooleanButton id="destaque" value="#{produtoController.produto.destaque}" onLabel="Destaque" 
                                       offLabel="Em destaque" onIcon="ui-icon-check" offIcon="ui-icon-close" style="width:200px">
                    <p:ajax update="msgs" listener="#{produtoController.addMessageDestaque()}" />
                </p:selectBooleanButton>
            </b:panelGrid>

            <b:panelGrid col-spans="12">
                <h:outputLabel value="Descrição detalhada da notícia *" for="descricao"/>
                <p:textEditor id="descricao" widgetVar="editorWidget" value="#{produtoController.produto.descricao}" height="300"
                              required="true" requiredMessage="informe a descrição da notícia" />
            </b:panelGrid>

            <b:panelGrid col-spans="10,2" style="margin-top: 1%;">
                <p:fileUpload fileUploadListener="#{produtoController.handleFileUpload}"
                              previewWidth="10" auto="false" label="Escolher a foto"
                              skinSimple="true" mode="advanced"
                              allowTypes="/(\.|\/)(gif|jpe?g|jpg|png|jfif)$/"
                              invalidFileMessage="São permitidas somente imagens (gif, jpeg, jpg e png)"
                              fileLimit="50" dragDropSupport="true" sizeLimit="16000000"
                              invalidSizeMessage="O tamanho máximo permitido é de 4MB."
                              fileLimitMessage="Só é possível escolher apenas 1 foto."
                              uploadLabel="Enviar" cancelLabel="Cancelar">
                </p:fileUpload>

                <a id="atrigger" class="btn btn-primary btn-lg" href="#amodal" data-toggle="modal">mais imagens</a>
            </b:panelGrid>

            <br></br>

            <b:panelGrid col-spans="12" style="margin-top: 1%;">
                <b:commandButton value="enviar" action="#{produtoController.salvar()}" look="primary" 
                                 icon-awesome="fa fa-checked" style="width:100%">
                    <f:ajax execute="@form" render="form" />
                </b:commandButton>
            </b:panelGrid>
        </h:form>

        <b:modal id="amodal" title="Formulário de arquivo" styleClass="modalPseudoClass">
            <h:form id="formArquivo">
                <b:messages/>
                <b:panelGrid columns="1">
                    <h:outputText value="Nome do arquivo" class="red-texto"/>
                    <b:inputText value="#{arquivoController.arquivo.nome}" placeholder="nome" 
                                 required="true" requiredMessage="campo obrigatório"/>

                    <h:outputText value="Descrição" class="red-texto"/>
                    <b:inputText value="#{arquivoController.arquivo.descricao}" 
                                 placeholder="descricao" maxlength="255"
                                 required="true" requiredMessage="campo obrigatório"/>
                </b:panelGrid>

                <b:panelGrid columns="1">
                    <h:outputText value="Arquivo" class="red-texto"/>
                    <p:fileUpload fileUploadListener="#{arquivoController.handleFileUpload}"
                                  previewWidth="10" auto="false" label="Escolher a foto"
                                  skinSimple="true" mode="advanced"
                                  allowTypes="/(\.|\/)(gif|jpe?g|jpg|png)$/"
                                  invalidFileMessage="São permitidas somente imagens (gif, jpeg, jpg e png)"
                                  fileLimit="50" dragDropSupport="true" sizeLimit="16000000"
                                  invalidSizeMessage="O tamanho máximo permitido é de 4MB."
                                  fileLimitMessage="Só é possível escolher apenas 1 foto."
                                  uploadLabel="Enviar" cancelLabel="Cancelar">
                    </p:fileUpload>
                </b:panelGrid>

                <br></br>

                <b:panelGrid columns="1">
                    <b:commandButton value="enviar" action="#{arquivoController.salvar()}" look="primary" icon-awesome="fa fa-checked" style="width:100%">
                        <f:ajax execute="@form" render="formArquivo" />
                    </b:commandButton>
                </b:panelGrid>
            </h:form>

            <f:facet name="footer">
                <b:button value="Close" dismiss="modal" />
                <b:button value="Ok" look="primary" dismiss="modal" />
            </f:facet>
        </b:modal>

        <br></br>


    </ui:define>
</ui:composition>